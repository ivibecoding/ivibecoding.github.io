import{_ as e,c as l,a as s,o as n}from"./app-BuzjU66J.js";const a={};function i(d,t){return n(),l("div",null,[...t[0]||(t[0]=[s(`<h1 id="视频压缩" tabindex="-1"><a class="header-anchor" href="#视频压缩"><span>视频压缩</span></a></h1><h2 id="压缩脚本对比" tabindex="-1"><a class="header-anchor" href="#压缩脚本对比"><span>压缩脚本对比</span></a></h2><p><strong>测试视频 145470kb 的 mkv 文件</strong></p><p><code>ffmpeg -i test.mkv-b 400k -vcodec libx264 -y test_video_handle.mkv</code></p><blockquote><p>时间长 10s 以上，CPU 占用率 95%，压缩后内存小 16152kb，画质无明显变化</p></blockquote><p><code>ffmpeg -i test.mkv -r 24 -b 400k -vcodec libx264 -preset ultrafast -qp 35 -y test_video_handle.mkv</code></p><blockquote><p>时间端 5s 左右，CPU 占用率 50%，压缩后内存稍大 20321kb，画质无明显变化</p></blockquote><ul><li>压缩后 MP4 视频比 mkv 内存稍大</li><li>需要在安装目录下 x64 文件夹增加 ffmpeg.exe</li></ul><table><thead><tr><th style="text-align:left;">命令</th><th style="text-align:left;">分辨率</th><th style="text-align:left;">帧率</th><th style="text-align:left;">比特率</th><th style="text-align:left;">压缩后占用空间</th><th style="text-align:left;">压缩速率</th></tr></thead><tbody><tr><td style="text-align:left;">ffmpeg -i input.mkv -vcodec libx264 -preset ultrafast -y output.mkv</td><td style="text-align:left;">1280*720</td><td style="text-align:left;">25</td><td style="text-align:left;">原视频比特率</td><td style="text-align:left;">168.873KB</td><td style="text-align:left;">44.5x</td></tr><tr><td style="text-align:left;">ffmpeg -i input.mkv -vcodec libx264 -y output.mkv</td><td style="text-align:left;">1280*720</td><td style="text-align:left;">25</td><td style="text-align:left;">原视频比特率</td><td style="text-align:left;">93.198KB</td><td style="text-align:left;">8.5x CPU100%</td></tr><tr><td style="text-align:left;">ffmpeg -i input.mkv -vcodec libx264 -preset ultrafast -qp 35 -y output.mkv</td><td style="text-align:left;">1280*720</td><td style="text-align:left;">25</td><td style="text-align:left;">原视频比特率</td><td style="text-align:left;">20.837KB</td><td style="text-align:left;">64x</td></tr><tr><td style="text-align:left;">ffmpeg -i input.mkv -vcodec libx264 -preset ultrafast -qp 25 -y output.mkv</td><td style="text-align:left;">1280*720</td><td style="text-align:left;">25</td><td style="text-align:left;">原视频比特率</td><td style="text-align:left;">97.303KB</td><td style="text-align:left;">62x</td></tr><tr><td style="text-align:left;">ffmpeg -i input.mkv -r 24 -b 400k -vcodec libx264 -y output.mkv</td><td style="text-align:left;">1280*720</td><td style="text-align:left;">24</td><td style="text-align:left;">400Kbit / s</td><td style="text-align:left;">16.161KB</td><td style="text-align:left;">17x</td></tr><tr><td style="text-align:left;">ffmpeg -i input.mkv -s 640x360 -vcodec libx264 -preset ultrafast -y output.mkv</td><td style="text-align:left;">640*360</td><td style="text-align:left;">25</td><td style="text-align:left;">原视频比特率</td><td style="text-align:left;">62.866KB</td><td style="text-align:left;">46.7x</td></tr><tr><td style="text-align:left;">ffmpeg -i input.mkv -s 640x360 -vcodec libx264 -y output.mkv</td><td style="text-align:left;">640*360</td><td style="text-align:left;">25</td><td style="text-align:left;">原视频比特率</td><td style="text-align:left;">19.840KB</td><td style="text-align:left;">32.3x</td></tr><tr><td style="text-align:left;">ffmpeg -i input.mkv -s 640x360 -r 24 -b 400k -vcodec libx264 -y output.mkv</td><td style="text-align:left;">640*360</td><td style="text-align:left;">24</td><td style="text-align:left;">400Kbit / s</td><td style="text-align:left;">16.071KB</td><td style="text-align:left;">35x</td></tr><tr><td style="text-align:left;">ffmpeg -i input.mkv -s 640x360 -vcodec libx264 -preset ultrafast -qp 35 -y output.mkv</td><td style="text-align:left;">640*360</td><td style="text-align:left;">25</td><td style="text-align:left;">原视频比特率</td><td style="text-align:left;">7.153KB</td><td style="text-align:left;">52x</td></tr></tbody></table><ul><li>强：<code>ffmpeg -i input.mkv -s 640x360 -vcodec libx264 -preset ultrafast -qp 35 -y output.mkv 7MB 51.9x</code></li><li>中：<code>ffmpeg -i input.mkv -vcodec libx264 -preset ultrafast -qp 35 -y output.mkv 20MB 64x</code></li><li>弱：<code>ffmpeg -i input.mkv -vcodec libx264 -preset ultrafast -qp 25 -y output.mkv 97MB 62x</code></li></ul><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token comment">// -i 设定输入流</span></span>
<span class="line"><span class="token comment">// -f 设定输出格式</span></span>
<span class="line"><span class="token comment">// - ss 开始时间</span></span>
<span class="line"><span class="token comment">// - b 设定视频流量(码率)</span></span>
<span class="line"><span class="token comment">// - r 设定帧速率</span></span>
<span class="line"><span class="token comment">// - s 设定画面的宽与高</span></span>
<span class="line"><span class="token comment">// - aspect 设定画面的比例</span></span>
<span class="line"><span class="token comment">// - vn 不处理视频</span></span>
<span class="line"><span class="token comment">// - vcodec 设定视频编解码器，未设定时则使用与输入流相同的编解码器</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// - ar 设定采样率</span></span>
<span class="line"><span class="token comment">// - ac 设定声音的Channel数</span></span>
<span class="line"><span class="token comment">// - acodec 设定声音编解码器，未设定时则使用与输入流相同的编解码器</span></span>
<span class="line"><span class="token comment">// - an 不处理音频</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="参考资料" tabindex="-1"><a class="header-anchor" href="#参考资料"><span>参考资料</span></a></h2><ul><li><a href="https://ffmpeg.org/ffmpeg-all.html" target="_blank" rel="noopener noreferrer">ffmpeg Documentation</a></li><li><a href="https://blog.csdn.net/ETalien_/article/details/102931065" target="_blank" rel="noopener noreferrer">ffmpeg：码率控制模式、编码方式</a></li></ul>`,13)])])}const c=e(a,[["render",i]]),o=JSON.parse('{"path":"/code/dotnet/VideoCompression/","title":"视频压缩","lang":"zh-CN","frontmatter":{},"git":{"contributors":[{"name":"Z小染","username":"","email":"ryning@sina.com","commits":1},{"name":"奶油拌云朵","username":"","email":"ryning@sina.com","commits":1}],"changelog":[{"hash":"5285ad22209916fb809ed102a8a5958264f17b15","time":1668600192000,"email":"ryning@sina.com","author":"奶油拌云朵","message":"update"},{"hash":"abcd352fb2100dea1534963bd2fbfc4b8f7e0696","time":1667792776000,"email":"ryning@sina.com","author":"Z小染","message":"add file"}]},"filePathRelative":"code/dotnet/VideoCompression/index.md"}');export{c as comp,o as data};
